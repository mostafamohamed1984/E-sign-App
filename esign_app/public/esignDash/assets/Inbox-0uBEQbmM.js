var C=(v,o,c)=>new Promise((f,m)=>{var g=s=>{try{n(c.next(s))}catch(u){m(u)}},x=s=>{try{n(c.throw(s))}catch(u){m(u)}},n=s=>s.done?f(s.value):Promise.resolve(s.value).then(g,x);n((c=c.apply(v,o)).next())});import{u as _,c as O,e as E,r as d,j as t}from"./index-D2N87orz.js";import{Q as D}from"./react-toastify.esm-D6PRyco7.js";import{S as p}from"./index-Dyiku-yA.js";import"./PurePanel-3dmlHpCG.js";import"./index-Dm3b0gWN.js";const M=()=>{const v=_(),o=O(E),[c,f]=d.useState([]),[m,g]=d.useState(!0),[x,n]=d.useState(null),[s,u]=d.useState("all"),[b,y]=d.useState(""),N=e=>{v(`/signer/${e.name}`,{state:{documentData:e}})};if(d.useEffect(()=>{o&&C(void 0,null,function*(){try{const r=yield fetch(`/api/method/esign_app.api.get_documents_by_user?user_mail=${o}`,{method:"GET",headers:{"Content-Type":"application/json"}}),a=yield r.json();r.status===200?a.message.data.length>0?f(a.message.data):n("No documents found"):n("Failed to fetch documents")}catch(r){n("An error occurred while fetching documents")}finally{g(!1)}})},[o]),m)return t.jsx("div",{children:"Loading..."});if(x)return t.jsx("div",{children:x});const j=e=>{try{return JSON.parse(e)}catch(r){return console.error("Failed to parse assigned_users:",r),{}}},S=c.filter(e=>{var h;const r=j(e.assigned_users),a=(h=Object.values(r).find(w=>w.email===o))==null?void 0:h.status,i=s==="all"||s==="unseen"&&a==="unseen"||s==="opened"&&a==="open"||s==="completed"&&a==="close",l=e.document_title.toLowerCase().includes(b.toLowerCase());return i&&l});return t.jsxs("div",{className:"relative mt-6 min-w-[1000px] max-w-[1000px] mx-auto",children:[t.jsxs("div",{className:"mb-4 flex gap-2 items-center max-w-40",children:[t.jsx("input",{type:"text",placeholder:"Search by document title...",value:b,onChange:e=>y(e.target.value),className:"border p-2 rounded-md flex-1"}),t.jsxs(p,{value:s,onChange:e=>u(e),className:"min-w-40",children:[t.jsx(p.Option,{value:"all",children:"All"}),t.jsx(p.Option,{value:"opened",children:"Opened"}),t.jsx(p.Option,{value:"completed",children:"Completed"}),t.jsx(p.Option,{value:"unseen",children:"Unseen"})]})]}),t.jsx("div",{className:"h-[90vh] overflow-y-auto",children:t.jsx("div",{className:"flex flex-wrap gap-5",children:S.map((e,r)=>{var h;const a=j(e.assigned_users),i=(h=Object.values(a).find(w=>w.email===o))==null?void 0:h.status;let l="";return e.isrejected?l="bg-[#de4343] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] opacity-50":i==="unseen"?l="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] relative":i==="open"?l="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42]":i==="close"&&(l="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] opacity-50"),t.jsx("div",{className:"w-[200px] h-[100px] relative",children:t.jsxs("div",{className:`p-4 rounded border-2 transition-colors duration-300 cursor-pointer ${l}`,onClick:()=>N(e),children:[t.jsx("h3",{className:`mt-2 font-bold ${i==="close"?"line-through":""} text-ellipsis overflow-hidden whitespace-nowrap`,children:e.document_title}),t.jsx("p",{className:"text-sm text-ellipsis overflow-hidden whitespace-nowrap",children:new Date(e.document_created_at).toLocaleString()}),i==="unseen"&&t.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-yellow-500 rounded-full shadow-md"})]})},r)})})}),t.jsx(D,{})]})};export{M as default};
